---

- name: "Set variables"
  set_fact:
     proxy_cron: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39646231343435643563323730306139616266363838623638613537323930326537346130663832
          6432636231376530316564626532663665633138623564300a643130303262313232346239353930
          38306262623065363631616431363863643561623461366531646362333632306362313139356462
          6635333639333534320a363165356535626464303537613464383762323462356535346165336432
          36343932396362613863643666386639633566623364306266613566666330326237633439303035
          37633035663737303733333231396637313963643037353132396263653934353234373664653539
          636631653230613738316633353863646339
     ssh_cleanup: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34333265633436613031346466363532343763333531663261313831373236356162313063326163
          3537663032316536313332633834363763303630363962360a343162383735376565623138633763
          63326632643762623834396362353633376533653562336165333061613562376537343163623634
          6365636231393936660a373437633063636264623963626461623137636561313530326530616636
          35613664313063616335653634333331333733393866396636353035643362643263326135663266
          3133323365393933616166393435346638386363373735373338


- name: Ensure Cron ansible job present
  become_user: "{{ main_user }}"
  ansible.builtin.cron:
    name: "Setup proxy"
    minute: "55"
    job: "{{ proxy_cron }}"
      
- name: Ensure Cron ansible job present
  become_user: "{{ main_user }}"
  ansible.builtin.cron:
    name: "kill old ssh processes"
    minute: "54"
    job: "{{ ssh_cleanup }}"
