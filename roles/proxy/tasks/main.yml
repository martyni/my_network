---

- name: "Set variables"
  set_fact:
     proxy_cron: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          39646231343435643563323730306139616266363838623638613537323930326537346130663832
          6432636231376530316564626532663665633138623564300a643130303262313232346239353930
          38306262623065363631616431363863643561623461366531646362333632306362313139356462
          6635333639333534320a363165356535626464303537613464383762323462356535346165336432
          36343932396362613863643666386639633566623364306266613566666330326237633439303035
          37633035663737303733333231396637313963643037353132396263653934353234373664653539
          636631653230613738316633353863646339
     ssh_cleanup: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          36323833353233633064383737363638623233313265656339616362616466303533336663613661
          3533663666363861323134343663373735396265623738370a636465363832643865343663353064
          36626532346266323938333031356361616238633235616335666537343732636161353765653535
          3363353233333737320a643762313936636462323234353532616265313864373831343235643432
          62636234366462396630616530326164336631373162643464313631363761346136333464346231
          3935646662616461613934636134306561363236343633343638

- name: Ensure Cron ansible job present
  become_user: "{{ main_user }}"
  ansible.builtin.cron:
    name: "Setup proxy"
    minute: "55"
    job: "{{ proxy_cron }}"
      
- name: Ensure Cron ansible job present
  become_user: "{{ main_user }}"
  ansible.builtin.cron:
    name: "kill old ssh processes"
    minute: "54"
    job: "{{ ssh_cleanup }}"
